<!DOCTYPE html>
<html lang="zxx">

<head>
  <title>Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta charset="utf-8">
  <meta name="keywords" content="Goggles a Responsive web template, Bootstrap Web Templates, Flat Web Templates, Android Compatible web template,
Smartphone Compatible web template, free webdesigns for Nokia, Samsung, LG, SonyEricsson, Motorola web design"/>
  <script>
    addEventListener("load", function () {
      setTimeout(hideURLbar, 0);
    }, false);

    function hideURLbar() {
      window.scrollTo(0, 1);
    }
  </script>
  <link href="css/bootstrap.css" rel='stylesheet' type='text/css'/>
  <link href="css/login_overlay.css" rel='stylesheet' type='text/css'/>
  <link href="css/style6.css" rel='stylesheet' type='text/css'/>
  <link rel="stylesheet" href="css/shop.css" type="text/css"/>
  <link rel="stylesheet" href="css/owl.carousel.css" type="text/css" media="all">
  <link rel="stylesheet" href="css/owl.theme.css" type="text/css" media="all">
  <link href="css/style.css" rel='stylesheet' type='text/css'/>
  <link href="css/fontawesome-all.css" rel="stylesheet">
  <link href="//fonts.googleapis.com/css?family=Inconsolata:400,700" rel="stylesheet">
  <link href="//fonts.googleapis.com/css?family=Poppins:100,100i,200,200i,300,300i,400,400i,500,500i,600,600i,700,700i,800"
        rel="stylesheet">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://cdn.datatables.net/1.10.18/js/jquery.dataTables.js"></script>
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://www.gstatic.com/firebasejs/4.2.0/firebase.js"></script>
  <link rel="stylesheet" href="css/profileUser.css">
  <link rel="stylesheet" href="css/freeStyle.css">
</head>

<body>
<script>
  const firebaseConfig = {
    apiKey: "AIzaSyDAcVDY54CgLrMsF62GM1UJt79U5YwUKMI",
    authDomain: "case-study-md4.firebaseapp.com",
    projectId: "case-study-md4",
    storageBucket: "case-study-md4.appspot.com",
    messagingSenderId: "1075801629660",
    appId: "1:1075801629660:web:ff596cc3eb33c2f37da519",
    measurementId: "G-VJFQG43GD9"
  };

  firebase.initializeApp(firebaseConfig);
</script>
<div class="banner-top container-fluid" id="home">
  <!-- header -->
  <header>
    <div class="row">
      <div class="col-md-3 top-info text-left mt-lg-4">
        <h6>Need Help</h6>
        <ul>
          <li>
            <i class="fas fa-phone"></i> Call
          </li>
          <li class="number-phone mt-3">12345678099</li>
        </ul>
      </div>
      <div class="col-md-6 logo-w3layouts text-center">
        <h1 class="logo-w3layouts">
          <a class="navbar-brand" href="index.html">
            Goggles </a>
        </h1>
      </div>

      <div class="col-md-3 top-info-cart text-right mt-lg-4">
        <ul class="cart-inner-info">
          <div class="header__navbar-item header__navbar-user">
            <li class="button-log">
              <a id="hiddenLogin" class="btn-open" href="#">
                <h4>Sign In</h4>
              </a>
            </li>
            <div id="usernamee" class="login-register-btn mr-50 mx-3">
              <a href="profileUser.html"><img id="userAvatar"></a>
              <span id="nameOfUser">Name</span>
            </div>
            <div id="logout" class="login-register-btn mr-50" style="cursor: pointer">
              <a onclick="logOut()">Log Out</a>
            </div>
          </div>
          <li class="galssescart galssescart2 cart cart box_1">
            <a href="cart.html" class="top_googles_cart" type="submit" name="submit" value="">
              My Cart
              <i class="fas fa-cart-arrow-down"></i>
            </a>
            <a id="admin" href="adminProfile.html" class="btn btn-color-pink submit mb-4">Management</a>
          </li>
        </ul>
        <!---->
        <div class="overlay-login text-left">
          <button type="button" class="overlay-close1">
            <i class="fa fa-times" aria-hidden="true"></i>
          </button>
          <div class="wrap">
            <h5 class="text-center mb-4">Login Now</h5>
            <div class="login p-5 bg-dark mx-auto mw-100">
              <div class="form-group">
                <label class="mb-2">UserName</label>
                <input type="text" name="username" class="form-control" id="username"
                       aria-describedby="emailHelp" placeholder="" required="">
                <small id="emailHelp" class="form-text text-muted">We'll never share your email with
                  anyone else.</small>
              </div>
              <div class="form-group">
                <label class="mb-2">Password</label>
                <input type="password" class="form-control" name="password" id="password" placeholder=""
                       required="">
              </div>
              <span id="status_login" style="color: red" class="alert"></span><br>
              <div class="form-check mb-2">
                <input type="checkbox" class="form-check-input" id="exampleCheck1">
                <label class="form-check-label" for="exampleCheck1">Check me out</label>
              </div>
              <button id="btn-login" type="submit" class="btn btn-primary submit mb-4">Sign In</button>
              <a href="SignUp.html" type="submit" class="btn btn-primary submit mb-4">Sign Up</a>
            </div>
            <!---->
          </div>
        </div>
        <!---->
      </div>
    </div>
    <div class="search">
      <div class="mobile-nav-button">
        <button id="trigger-overlay" type="button">
          <i class="fas fa-search"></i>
        </button>
      </div>
      <!-- open/close -->
      <div class="overlay overlay-door">
        <button type="button" class="overlay-close">
          <i class="fa fa-times" aria-hidden="true"></i>
        </button>
        <form action="#" method="post" class="d-flex">
          <input class="form-control" type="search" placeholder="Search here..." required="">
          <button type="submit" class="btn btn-primary submit">
            <i class="fas fa-search"></i>
          </button>
        </form>

      </div>
      <!-- open/close -->
    </div>
    <label class="top-log mx-auto"></label>
    <nav class="navbar navbar-expand-lg navbar-light bg-light top-header mb-2">

      <button class="navbar-toggler mx-auto" type="button" data-toggle="collapse"
              data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
              aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon">

					</span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav nav-mega mx-auto">
          <li class="nav-item active">
            <a class="nav-link ml-lg-0" href="index.html">Home
              <span class="sr-only">(current)</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="about.html">About</a>
          </li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button"
               data-toggle="dropdown" aria-haspopup="true"
               aria-expanded="false">
              Features
            </a>
            <ul class="dropdown-menu mega-menu ">
              <li>
                <div class="row">
                  <div class="col-md-4 media-list span4 text-left">
                    <h5 class="tittle-w3layouts-sub"> Tittle goes here </h5>
                    <ul>
                      <li class="media-mini mt-3">
                        <a href="combatAircrafts.html">Designer Glasses</a>
                      </li>
                      <li class="">
                        <a href="combatAircrafts.html"> Ray-Ban</a>
                      </li>
                      <li>
                        <a href="combatAircrafts.html">Prescription Glasses</a>
                      </li>
                      <li class="mt-3">
                        <h5>View more pages</h5>
                      </li>
                      <li class="mt-2">
                        <a href="about.html">About</a>
                      </li>
                      <li>
                        <a href="customer.html">Customers</a>
                      </li>
                    </ul>
                  </div>
                  <div class="col-md-4 media-list span4 text-left">
                    <h5 class="tittle-w3layouts-sub"> Tittle goes here </h5>
                    <div class="media-mini mt-3">
                      <a href="combatAircrafts.html">
                        <img src="images/g2.jpg" class="img-fluid" alt="">
                      </a>
                    </div>
                  </div>
                  <div class="col-md-4 media-list span4 text-left">
                    <h5 class="tittle-w3layouts-sub">Tittle goes here </h5>
                    <div class="media-mini mt-3">
                      <a href="combatAircrafts.html">
                        <img src="images/g3.jpg" class="img-fluid" alt="">
                      </a>
                    </div>

                  </div>
                </div>
                <hr>
              </li>
            </ul>
          </li>
          <li class="nav-item dropdown active">
            <nav class="navbar navbar-expand-lg bg-light navbar-light py-3 py-lg-0 px-0">
              <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
                <div class="navbar-nav mr-auto py-0">
                  <div class="nav-item dropdown">
                    <a href="#" class="nav-link dropdown-toggle"
                       id="navbarDropdown1" role="button" aria-haspopup="true"
                       aria-expanded="false" data-toggle="dropdown">Shop</a>
                    <div class="dropdown-menu rounded-0 m-0">
                      <a href="combatAircrafts.html" class="dropdown-item">Máy bay chiến đấu</a>
                      <a href="bomberPlane.html" class="dropdown-item">Máy bay ném bom</a>
                      <a href="combatHelicopters.html" class="dropdown-item">Trực thăng chiến
                        đấu</a>
                    </div>
                  </div>
                </div>
              </div>
            </nav>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contact.html">Contact</a>
          </li>
        </ul>

      </div>
    </nav>
  </header>
  <!-- //header -->
</div>
<!--profile-->
<div class="container">
  <div class="view-account">
    <section class="module">
      <div class="module-inner">
        <div class="side-bar">
          <div class="user-info">
            <img class="mx-auto" style="width: 140px; height: 140px; border-radius: 16px"
                 id="imgDiv1" src="">
            <ul class="meta list list-unstyled">
              <li class="name">
                <label class="label label-info">UX Designer</label>
              </li>
              <li class="activity">Last logged in: Today at 2:18pm</li>
            </ul>
          </div>
        </div>
        <div class="content-panel">
          <h2 class="title">Profile<span class="pro-label label label-warning">PRO</span></h2>
          <div class="form-horizontal">
            <fieldset class="fieldset">
              <h3 class="fieldset-title">Personal Info</h3>
              <div class="form-group avatar">
                <figure class="figure col-md-2 col-sm-3 col-xs-12">
                  <img id="imgDiv" class="img-rounded img-responsive" alt="" src="">
                </figure>
                <div class="form-inline col-md-10 col-sm-9 col-xs-12">
                  <div class="mt-2">
                    <i class="fa fa-fw fa-camera"></i>
                    <input type="file" value="upload" accept=".jpg" id="fileButton">
                  </div>
                </div>
              </div>
              <div class="form-group">
                <input type="text" id="id" hidden>
                <label class="col-md-2 col-sm-3 col-xs-12 control-label">Full Name</label>
                <div class="col-md-10 col-sm-9 col-xs-12">
                  <input id="fullName" type="text" class="form-control">
                </div>
              </div>
              <div class="form-group">
                <label class="col-md-2 col-sm-3 col-xs-12 control-label">User Name</label>
                <div class="col-md-10 col-sm-9 col-xs-12">
                  <input id="usernameee" type="text" class="form-control">
                </div>
              </div>
              <div class="form-group">
                <label class="col-md-2 col-sm-3 col-xs-12 control-label">Password</label>
                <div class="col-md-10 col-sm-9 col-xs-12">
                  <input class="col-md-2 col-sm-3 col-xs-12 control-label" type="password"
                         placeholder="••••••" id="passwordEdit" >
                </div>
              </div>
            </fieldset>
            <fieldset class="fieldset">
              <h3 class="fieldset-title">Contact Info</h3>
              <div class="form-group">
                <label class="col-md-2  col-sm-3 col-xs-12 control-label">Email</label>
                <div class="col-md-10 col-sm-9 col-xs-12">
                  <input id="email" type="email" class="form-control">
                  <p class="help-block">This is the email </p>
                </div>
              </div>
            </fieldset>
            <hr>
            <div class="form-group">
              <div class="col-md-10 col-sm-9 col-xs-12 col-md-push-2 col-sm-push-3 col-xs-push-0">
                <button onclick="editUserProfile()" class="btn btn-primary" type="submit" >Update Profile</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>
<!--//profile-->
<!--footer -->
<footer class="py-lg-5 py-3">
  <div class="container-fluid px-lg-5 px-3">
    <div class="row footer-top-w3layouts">
      <div class="col-lg-3 footer-grid-w3ls">
        <div class="footer-title">
          <h3>About Us</h3>
        </div>
        <div class="footer-text">
          <p>Curabitur non nulla sit amet nislinit tempus convallis quis ac lectus. lac inia eget consectetur
            sed, convallis at
            tellus. Nulla porttitor accumsana tincidunt.</p>
          <ul class="footer-social text-left mt-lg-4 mt-3">

            <li class="mx-2">
              <a href="#">
                <span class="fab fa-facebook-f"></span>
              </a>
            </li>
            <li class="mx-2">
              <a href="#">
                <span class="fab fa-twitter"></span>
              </a>
            </li>
            <li class="mx-2">
              <a href="#">
                <span class="fab fa-google-plus-g"></span>
              </a>
            </li>
            <li class="mx-2">
              <a href="#">
                <span class="fab fa-linkedin-in"></span>
              </a>
            </li>
            <li class="mx-2">
              <a href="#">
                <span class="fas fa-rss"></span>
              </a>
            </li>
            <li class="mx-2">
              <a href="#">
                <span class="fab fa-vk"></span>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="col-lg-3 footer-grid-w3ls">
        <div class="footer-title">
          <h3>Get in touch</h3>
        </div>
        <div class="contact-info">
          <h4>Location :</h4>
          <p>0926k 4th block building, king Avenue, New York City.</p>
          <div class="phone">
            <h4>Contact :</h4>
            <p>Phone : +121 098 8907 9987</p>
            <p>Email :
              <a href="mailto:info@example.com">info@example.com</a>
            </p>
          </div>
        </div>
      </div>
      <div class="col-lg-3 footer-grid-w3ls">
        <div class="footer-title">
          <h3>Quick Links</h3>
        </div>
        <ul class="links">
          <li>
            <a href="index.html">Home</a>
          </li>
          <li>
            <a href="about.html">About</a>
          </li>
          <li>
            <a href="404.html">Error</a>
          </li>
          <li>
            <a href="combatAircrafts.html">Shop</a>
          </li>
          <li>
            <a href="contact.html">Contact Us</a>
          </li>
        </ul>
      </div>
      <div class="col-lg-3 footer-grid-w3ls">
        <div class="footer-title">
          <h3>Sign up for your offers</h3>
        </div>
        <div class="footer-text">
          <p>By subscribing to our mailing list you will always get latest news and updates from us.</p>
          <form action="#" method="post">
            <input class="form-control" type="email" name="Email" placeholder="Enter your email..."
                   required="">
            <button class="btn1">
              <i class="far fa-envelope" aria-hidden="true"></i>
            </button>
            <div class="clearfix"></div>
          </form>
        </div>
      </div>
    </div>
    <div class="copyright-w3layouts mt-4">
      <p class="copy-right text-center ">&copy; 2018 Goggles. All Rights Reserved | Design by
        <a href="http://w3layouts.com/"> W3layouts </a>
      </p>
    </div>
  </div>
</footer>
<!-- //footer -->

<!--jQuery-->
<script src="js/jquery-2.2.3.min.js"></script>
<!-- newsletter modal -->
<!-- Modal -->
<script>
  $(document).ready(function () {
    $("#myModal").modal();
  });
</script>
<!-- // modal -->

<!--search jQuery-->
<script src="js/modernizr-2.6.2.min.js"></script>
<script src="js/classie-search.js"></script>
<script src="js/demo1-search.js"></script>
<!--//search jQuery-->
<!-- cart-js -->
<script src="js/minicart.js"></script>
<script>
  googles.render();

  googles.cart.on('googles_checkout', function (evt) {
    var items, len, i;

    if (this.subtotal() > 0) {
      items = this.items();

      for (i = 0, len = items.length; i < len; i++) {
      }
    }
  });
</script>
<!-- //cart-js -->
<script>
  $(document).ready(function () {
    $(".button-log a").click(function () {
      $(".overlay-login").fadeToggle(200);
      $(this).toggleClass('btn-open').toggleClass('btn-close');
    });
  });
  $('.overlay-close1').on('click', function () {
    $(".overlay-login").fadeToggle(200);
    $(".button-log a").toggleClass('btn-open').toggleClass('btn-close');
    open = false;
  });
</script>
<!-- carousel -->
<!-- Count-down -->
<script src="js/simplyCountdown.js"></script>
<link href="css/simplyCountdown.css" rel='stylesheet' type='text/css'/>
<script>
  var d = new Date();
  simplyCountdown('simply-countdown-custom', {
    year: d.getFullYear(),
    month: d.getMonth() + 2,
    day: 25
  });
</script>
<!--// Count-down -->
<script src="js/owl.carousel.js"></script>
<script>
  $(document).ready(function () {
    $('.owl-carousel').owlCarousel({
      loop: true,
      margin: 10,
      responsiveClass: true,
      responsive: {
        0: {
          items: 1,
          nav: true
        },
        600: {
          items: 2,
          nav: false
        },
        900: {
          items: 3,
          nav: false
        },
        1000: {
          items: 4,
          nav: true,
          loop: false,
          margin: 20
        }
      }
    })
  })
</script>

<!-- //end-smooth-scrolling -->


<!-- dropdown nav -->
<script>
  $(document).ready(function () {
    $(".dropdown").hover(
            function () {
              $('.dropdown-menu', this).stop(true, true).slideDown("fast");
              $(this).toggleClass('open');
            },
            function () {
              $('.dropdown-menu', this).stop(true, true).slideUp("fast");
              $(this).toggleClass('open');
            }
    );
  });
</script>
<!-- //dropdown nav -->
<script src="js/move-top.js"></script>
<script src="js/easing.js"></script>
<script>
  jQuery(document).ready(function ($) {
    $(".scroll").click(function (event) {
      event.preventDefault();
      $('html,body').animate({
        scrollTop: $(this.hash).offset().top
      }, 900);
    });
  });
</script>
<script>
  $(document).ready(function () {
    /*
                            var defaults = {
                                  containerID: 'toTop', // fading element id
                                containerHoverID: 'toTopHover', // fading element hover id
                                scrollSpeed: 1200,
                                easingType: 'linear'
                             };
                            */

    $().UItoTop({
      easingType: 'easeOutQuart'
    });

  });
</script>
<!--// end-smoth-scrolling -->

<script src="js/bootstrap.js"></script>
<!-- js file -->
<script src="js/signIn/signIn.js"></script>
<script src="js/main/logOut.js"></script>
<script src="js/main/user.js"></script>
<script type="text/javascript">
  let srcImg;
  var image = '';
  // firebase bucket name
  // REPLACE WITH THE ONE YOU CREATE
  // ALSO CHECK STORAGE RULES IN FIREBASE CONSOLE
  var fbBucketName = 'images';

  // get elements
  var uploader = document.getElementById('uploader');
  var fileButton = document.getElementById('fileButton');

  // listen for file selection
  fileButton.addEventListener('change', function (e) {

    // what happened
    console.log('file upload event', e);

    // get file
    var file = e.target.files[0];

    // create a storage ref
    var storageRef = firebase.storage().ref(`${fbBucketName}/${file.name}`);

    // upload file
    var uploadTask = storageRef.put(file);

    // The part below is largely copy-pasted from the 'Full Example' section from
    // https://firebase.google.com/docs/storage/web/upload-files

    // update progress bar
    uploadTask.on(firebase.storage.TaskEvent.STATE_CHANGED, // or 'state_changed'
            function (snapshot) {
              // Get task progress, including the number of bytes uploaded and the total number of bytes to be uploaded
              // var progress = (snapshot.bytesTransferred / snapshot.totalBytes) * 100;
              // uploader.value = progress;
              // console.log('Upload is ' + progress + '% done');
              switch (snapshot.state) {
                case firebase.storage.TaskState.PAUSED: // or 'paused'
                  console.log('Upload is paused');
                  break;
                case firebase.storage.TaskState.RUNNING: // or 'running'
                  console.log('Upload is running');
                  break;
              }
            }, function (error) {

              // A full list of error codes is available at
              // https://firebase.google.com/docs/storage/web/handle-errors
              switch (error.code) {
                case 'storage/unauthorized':
                  // User doesn't have permission to access the object
                  break;

                case 'storage/canceled':
                  // User canceled the upload
                  break;

                case 'storage/unknown':
                  // Unknown error occurred, inspect error.serverResponse
                  break;
              }
            }, function () {
              // Upload completed successfully, now we can get the download URL
              // save this link somewhere, e.g. put it in an input field
              var downloadURL = uploadTask.snapshot.downloadURL;
              // image = downloadURL;
              console.log('downloadURL ===>', downloadURL);
              let img = document.getElementById("imgDiv");
              img.src = downloadURL
              srcImg = downloadURL
              console.log('pic ==', downloadURL)
            });

  });

  function getProfileUser() {
    let users = window.sessionStorage.getItem("USER_KEY");
    console.log(users)
    let name = user.name;
    let username = user.username;
    let email = user.email;
    let id = user.id;
    let img = document.getElementById("imgDiv");
    let img1 = document.getElementById("imgDiv1");
    img.src = user.avatar;
    img1.src = user.avatar;

    document.getElementById("fullName").value = name;
    document.getElementById("usernameee").value = username;
    document.getElementById("email").value = email;
    document.getElementById("id").value = id;
  }

  getProfileUser();

  function editUserProfile() {
    let id = document.getElementById("id").value;
    let name = document.getElementById("fullName").value;
    let avatar = document.getElementById("imgDiv").src;
    let username = document.getElementById("usernameee").value;
    let email = document.getElementById("email").value;
    let password = document.getElementById("passwordEdit").value;

    let user = {
      'id': id,
      'name': name,
      'avatar': avatar,
      'username': username,
      'email': email,
      'password': password
    }

    $.ajax({
      type: "PUT",
      headers: {
        'Accept': 'application/json',
        'Content-Type': 'application/json'
      },
      url: "http://localhost:8080/users/" + id,
      data: JSON.stringify(user),
      //xử lý khi thành công
      success: function (data) {
        window.sessionStorage.removeItem("USER_KEY")
        window.sessionStorage.setItem("USER_KEY", JSON.stringify(data))
        window.location.href = 'profileUser.html';
        alert("Edit Success!")
      },
      error: function (err) {
        console.log(err)
      }
    })
  }
</script>
</body>
</html>